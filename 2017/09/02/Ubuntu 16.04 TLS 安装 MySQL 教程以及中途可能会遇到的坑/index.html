<!DOCTYPE html><html><head><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><title>  · Blog</title><meta name="description" content=" - ifzm"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="icon" href="/favicon.png"><link rel="stylesheet" href="/css/apollo.css"><link rel="search" type="application/opensearchdescription+xml" href="http://blog.ifzm.cn/atom.xml" title="Blog"></head><body><div class="wrap"><header><a href="/" class="logo-link"><img src="/favicon.png" alt="logo"></a><ul class="nav nav-list"><li class="nav-list-item"><a href="/" target="_self" class="nav-list-link">BLOG</a></li><li class="nav-list-item"><a href="/archives/" target="_self" class="nav-list-link">ARCHIVE</a></li><li class="nav-list-item"><a href="http://weibo.com/sunchongsheng" target="_blank" class="nav-list-link">WEIBO</a></li><li class="nav-list-item"><a href="https://github.com/pinggod" target="_blank" class="nav-list-link">GITHUB</a></li><li class="nav-list-item"><a href="/atom.xml" target="_self" class="nav-list-link">RSS</a></li></ul></header><main class="container"><div class="post"><article class="post-block"><h1 class="post-title"></h1><div class="post-info">Sep 2, 2017</div><div class="post-content"><h5 id="Ubuntu-16-04-TLS-安装-MySQL-教程以及中途可能会遇到的坑"><a href="#Ubuntu-16-04-TLS-安装-MySQL-教程以及中途可能会遇到的坑" class="headerlink" title="Ubuntu 16.04 TLS 安装 MySQL 教程以及中途可能会遇到的坑"></a>Ubuntu 16.04 TLS 安装 MySQL 教程以及中途可能会遇到的坑</h5><ol>
<li><p>命令安装，会提示输入 <code>mysql</code> 的 <code>root</code> 账户的密码</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">➜  ~  sudo apt-get install mysql-server</div><div class="line">➜  ~  sudo apt-get install mysql-client</div><div class="line">➜  ~  sudo apt-get install libmysqlclient-dev</div><div class="line">      </div><div class="line"># 中途遇到问题，通常可以通过下面的命令解决，如果还是有其他问题，请跳到最后看一些常见的问题解决</div><div class="line">➜  ~  sudo apt-get update</div><div class="line">➜  ~  sudo apt-get install -f</div></pre></td></tr></table></figure>
</li>
<li><p>如果上面的命令都正确执行，则执行下面的命令确认是否成功（结果如果和下面的类似，就代表成功了）</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">➜  ~  sudo netstat -tap | grep mysql</div><div class="line">tcp6       0      0 [::]:mysql              [::]:*                  LISTEN      7510/mysqld</div></pre></td></tr></table></figure>
</li>
<li><p>设置远程访问（<strong>非必要</strong>）</p>
<p>第一步，修改IP限制：</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"># 执行下面的一条命令找到 bind-address = 127.0.0.1 并注释，修改为 # bind-address = 127.0.0.1</div><div class="line">➜  ~  vim /etc/mysql/my.cnf 或 sudo gedit /etc/mysql/my.cnf</div><div class="line"></div><div class="line"># 修改完成后重启 mysql</div><div class="line">➜  ~  sudo /etc/init.d/mysql restart</div></pre></td></tr></table></figure>
<p>第二步，用户授权：</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">➜  ~  mysql -uroot -p123456</div><div class="line"></div><div class="line">Welcome to the MySQL monitor...</div><div class="line"></div><div class="line"># *.*：第一个*代表数据库名；第二个*代表表名。这里的意思是所有数据库里的所有表都授权给用户。root：授予root账号</div><div class="line"># %：表示授权的用户IP可以指定，这里代表任意的IP地址都能访问MySQL数据库</div><div class="line"># 123456：表示分配账号对应的密码，这里密码自己替换成你的mysql root帐号密码</div><div class="line">mysql&gt; grant all on *.* to root@'%' identified by '123456' with grand option;</div><div class="line"># 刷新权限信息，也即是让我们所作的设置马上生效</div><div class="line">mysql&gt; flush privileges;</div><div class="line"># 退出</div><div class="line">mysql&gt; exit;</div></pre></td></tr></table></figure>
</li>
<li><p>常见问题集锦：</p>
<ul>
<li><figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"># 安装出现类似下面的情况</div><div class="line">...</div><div class="line">error processing mysql-server-5.7 (--configrue): 子进程 已安装 post-installation 脚本</div><div class="line">然而 mysql-server-5.7 尚未配置 ...</div><div class="line">...</div><div class="line">E: Sub-process /usr/bin/dpkg returned an error code (1)</div><div class="line"></div><div class="line"># 尝试执行下面的命令</div><div class="line">➜  ~  sudo rm /var/lib/mysql/ -R</div><div class="line">➜  ~  sudo rm /etc/mysql/ -R</div><div class="line">➜  ~  sudo apt-get autoremove mysql* --purge</div><div class="line">➜  ~  sudo apt-get remove apparmor</div><div class="line">➜  ~  sudo apt-get autoclean</div><div class="line"></div><div class="line"># 中途如果没有其他错误，则可以回到最上面的安装教程</div></pre></td></tr></table></figure>
</li>
<li><figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"># 卸载出现类似下面的情况</div><div class="line">...</div><div class="line">error processing mysql-server-5.7 (--purge): 子进程 已安装 pre-removal 脚本</div><div class="line">然而 mysql-server-5.7 尚未配置 ...</div><div class="line">...</div><div class="line">E: Sub-process /usr/bin/dpkg returned an error code (1)</div><div class="line">  </div><div class="line"># 请确认错误信息中是否包含 `missing LSB tags and overrides` 这类警告或错误，如果有，通常是自定义的开机启动脚本书写不规范导致的，需要找到对应的启动脚本，进行修改，下面以 `redis` 开启启动为例，没有填写 `BEGIN INIT INFO` - `END INIT INFO` 这一段,也是会出现无法彻底卸载或安装MySQL的原因之一...</div></pre></td></tr></table></figure>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line">#!/bin/sh</div><div class="line"># chkconfig:   2345 90 10</div><div class="line"># description:  Redis is a persistent key-value database</div><div class="line">#</div><div class="line"># Simple Redis init.d script conceived to work on Linux systems</div><div class="line"># as it does use of the /proc filesystem.</div><div class="line">### BEGIN INIT INFO</div><div class="line"># Provides:          redis6379</div><div class="line"># Required-Start:    $local_fs $network</div><div class="line"># Required-Stop:     $local_fs</div><div class="line"># Default-Start:     2 3 4 5</div><div class="line"># Default-Stop:      0 1 6</div><div class="line"># Short-Description: redis6379</div><div class="line"># Description:       penavico redis 6379</div><div class="line">### END INIT INFO</div><div class="line"></div><div class="line">REDISPORT=6379</div><div class="line">EXEC=/usr/local/bin/redis-server</div><div class="line">CLIEXEC=/usr/local/bin/redis-cli</div><div class="line">...</div></pre></td></tr></table></figure>
<p>​</p>
</li>
</ul>
<p>​</p>
</li>
</ol>
</div></article></div></main><footer><div class="paginator"><a href="/2017/09/02/hello-world/" class="prev">PREV</a><a href="/2016/07/11/shadowsocks-course/" class="next">NEXT</a></div><div class="copyright"><p>© 2015 - 2017 <a href="http://blog.ifzm.cn">ifzm</a>, powered by <a href="https://hexo.io/" target="_blank">Hexo</a> and <a href="https://github.com/pinggod/hexo-theme-apollo" target="_blank">hexo-theme-apollo</a>.</p></div></footer></div><script async src="//cdn.bootcss.com/mathjax/2.7.0/MathJax.js?config=TeX-MML-AM_CHTML" integrity="sha384-crwIf/BuaWM9rM65iM+dWFldgQ1Un8jWZMuh3puxb8TOY9+linwLoI7ZHZT+aekW" crossorigin="anonymous"></script><script>(function(b,o,i,l,e,r){b.GoogleAnalyticsObject=l;b[l]||(b[l]=function(){(b[l].q=b[l].q||[]).push(arguments)});b[l].l=+new Date;e=o.createElement(i);r=o.getElementsByTagName(i)[0];e.src='//www.google-analytics.com/analytics.js';r.parentNode.insertBefore(e,r)}(window,document,'script','ga'));ga('create',"UA-65933410-1",'auto');ga('send','pageview');</script></body></html>