<!DOCTYPE html><html><head><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><title> Java 数据库表生成 Entity 工具类 · Blog</title><meta name="description" content="Java 数据库表生成 Entity 工具类 - ifzm"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="icon" href="/favicon.png"><link rel="stylesheet" href="/css/apollo.css"><link rel="search" type="application/opensearchdescription+xml" href="http://blog.ifzm.cn/atom.xml" title="Blog"></head><body><div class="wrap"><header><a href="/" class="logo-link"><img src="/favicon.png" alt="logo"></a><ul class="nav nav-list"><li class="nav-list-item"><a href="/" target="_self" class="nav-list-link">BLOG</a></li><li class="nav-list-item"><a href="/archives/" target="_self" class="nav-list-link">ARCHIVE</a></li><li class="nav-list-item"><a href="http://weibo.com/sunchongsheng" target="_blank" class="nav-list-link">WEIBO</a></li><li class="nav-list-item"><a href="https://github.com/pinggod" target="_blank" class="nav-list-link">GITHUB</a></li><li class="nav-list-item"><a href="/atom.xml" target="_self" class="nav-list-link">RSS</a></li></ul></header><main class="container"><div class="post"><article class="post-block"><h1 class="post-title">Java 数据库表生成 Entity 工具类</h1><div class="post-info">Sep 2, 2017</div><div class="post-content"><p><div class="tip">这是一个整理出来的JAVA工具类，用于将MySQL数据库表生成Entity实体类</div><a id="more"></a><br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div><div class="line">135</div><div class="line">136</div><div class="line">137</div><div class="line">138</div><div class="line">139</div><div class="line">140</div><div class="line">141</div><div class="line">142</div><div class="line">143</div><div class="line">144</div><div class="line">145</div><div class="line">146</div><div class="line">147</div><div class="line">148</div><div class="line">149</div><div class="line">150</div><div class="line">151</div><div class="line">152</div><div class="line">153</div><div class="line">154</div><div class="line">155</div><div class="line">156</div><div class="line">157</div><div class="line">158</div><div class="line">159</div><div class="line">160</div><div class="line">161</div><div class="line">162</div><div class="line">163</div><div class="line">164</div><div class="line">165</div><div class="line">166</div><div class="line">167</div><div class="line">168</div><div class="line">169</div><div class="line">170</div><div class="line">171</div><div class="line">172</div><div class="line">173</div><div class="line">174</div><div class="line">175</div><div class="line">176</div><div class="line">177</div><div class="line">178</div><div class="line">179</div><div class="line">180</div><div class="line">181</div><div class="line">182</div><div class="line">183</div><div class="line">184</div><div class="line">185</div><div class="line">186</div><div class="line">187</div><div class="line">188</div><div class="line">189</div><div class="line">190</div><div class="line">191</div><div class="line">192</div><div class="line">193</div><div class="line">194</div><div class="line">195</div><div class="line">196</div><div class="line">197</div><div class="line">198</div><div class="line">199</div><div class="line">200</div><div class="line">201</div><div class="line">202</div><div class="line">203</div><div class="line">204</div><div class="line">205</div><div class="line">206</div><div class="line">207</div><div class="line">208</div><div class="line">209</div><div class="line">210</div><div class="line">211</div><div class="line">212</div><div class="line">213</div><div class="line">214</div><div class="line">215</div><div class="line">216</div><div class="line">217</div><div class="line">218</div><div class="line">219</div><div class="line">220</div><div class="line">221</div><div class="line">222</div><div class="line">223</div><div class="line">224</div><div class="line">225</div><div class="line">226</div><div class="line">227</div><div class="line">228</div><div class="line">229</div><div class="line">230</div><div class="line">231</div><div class="line">232</div><div class="line">233</div><div class="line">234</div><div class="line">235</div><div class="line">236</div><div class="line">237</div><div class="line">238</div><div class="line">239</div><div class="line">240</div><div class="line">241</div><div class="line">242</div><div class="line">243</div><div class="line">244</div><div class="line">245</div><div class="line">246</div><div class="line">247</div><div class="line">248</div><div class="line">249</div><div class="line">250</div><div class="line">251</div><div class="line">252</div><div class="line">253</div><div class="line">254</div><div class="line">255</div><div class="line">256</div><div class="line">257</div><div class="line">258</div><div class="line">259</div><div class="line">260</div><div class="line">261</div><div class="line">262</div><div class="line">263</div><div class="line">264</div><div class="line">265</div><div class="line">266</div><div class="line">267</div><div class="line">268</div><div class="line">269</div><div class="line">270</div><div class="line">271</div><div class="line">272</div><div class="line">273</div><div class="line">274</div><div class="line">275</div><div class="line">276</div><div class="line">277</div><div class="line">278</div><div class="line">279</div><div class="line">280</div><div class="line">281</div><div class="line">282</div><div class="line">283</div><div class="line">284</div><div class="line">285</div><div class="line">286</div><div class="line">287</div><div class="line">288</div><div class="line">289</div><div class="line">290</div><div class="line">291</div><div class="line">292</div><div class="line">293</div><div class="line">294</div><div class="line">295</div><div class="line">296</div><div class="line">297</div><div class="line">298</div><div class="line">299</div><div class="line">300</div><div class="line">301</div><div class="line">302</div><div class="line">303</div><div class="line">304</div><div class="line">305</div><div class="line">306</div><div class="line">307</div><div class="line">308</div><div class="line">309</div><div class="line">310</div><div class="line">311</div><div class="line">312</div><div class="line">313</div><div class="line">314</div><div class="line">315</div><div class="line">316</div><div class="line">317</div><div class="line">318</div><div class="line">319</div><div class="line">320</div><div class="line">321</div><div class="line">322</div><div class="line">323</div><div class="line">324</div><div class="line">325</div><div class="line">326</div><div class="line">327</div><div class="line">328</div><div class="line">329</div><div class="line">330</div><div class="line">331</div><div class="line">332</div><div class="line">333</div><div class="line">334</div><div class="line">335</div><div class="line">336</div><div class="line">337</div><div class="line">338</div><div class="line">339</div><div class="line">340</div><div class="line">341</div><div class="line">342</div><div class="line">343</div><div class="line">344</div><div class="line">345</div><div class="line">346</div><div class="line">347</div><div class="line">348</div><div class="line">349</div><div class="line">350</div><div class="line">351</div><div class="line">352</div><div class="line">353</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">package</span> com.nmore.smile.utils;</div><div class="line"></div><div class="line"><span class="keyword">import</span> java.io.File;</div><div class="line"><span class="keyword">import</span> java.io.FileWriter;</div><div class="line"><span class="keyword">import</span> java.io.PrintWriter;</div><div class="line"><span class="keyword">import</span> java.sql.Connection;</div><div class="line"><span class="keyword">import</span> java.sql.DriverManager;</div><div class="line"><span class="keyword">import</span> java.sql.ResultSet;</div><div class="line"><span class="keyword">import</span> java.sql.SQLException;</div><div class="line"><span class="keyword">import</span> java.sql.Statement;</div><div class="line"><span class="keyword">import</span> java.util.Date;</div><div class="line"><span class="keyword">import</span> java.util.HashMap;</div><div class="line"><span class="keyword">import</span> java.util.Map;</div><div class="line"></div><div class="line"><span class="comment">/**</span></div><div class="line"><span class="comment"> * <span class="doctag">@ClassName</span>: GenEntity </span></div><div class="line"><span class="comment"> * <span class="doctag">@Description</span>: 数据库表生成Entity工具类</span></div><div class="line"><span class="comment"> * <span class="doctag">@Author</span> devfzm@gmail.com</span></div><div class="line"><span class="comment"> * <span class="doctag">@Date</span> 2016年2月29日 上午10:13:36 </span></div><div class="line"><span class="comment"> *</span></div><div class="line"><span class="comment"> */</span></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">GenEntity</span> </span>&#123;</div><div class="line"></div><div class="line">    <span class="comment">//输出到自定义目录，为空代表输出到当前目录</span></div><div class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> String PATH = <span class="string">""</span>;</div><div class="line">    <span class="comment">//包名(当指定PATH时，请同步修改PACKAGE，为空则默认为当前目录),如:com.nmore.smile.entity</span></div><div class="line">    <span class="keyword">private</span> <span class="keyword">static</span> String PACKAGE = <span class="string">""</span>;</div><div class="line">true</div><div class="line">    <span class="comment">//数据库连接</span></div><div class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> String DATABASE = <span class="string">"imall"</span>;</div><div class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> String URL =<span class="string">"jdbc:mysql://localhost:3306/"</span>+ DATABASE +<span class="string">"?useUnicode=true&amp;characterEncoding=UTF8&amp;useSSL=false"</span>;</div><div class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> String NAME = <span class="string">"root"</span>;</div><div class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> String PASS = <span class="string">"123456"</span>;</div><div class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> String DRIVER =<span class="string">"com.mysql.jdbc.Driver"</span>;</div><div class="line">    </div><div class="line">    <span class="comment">//用于生成实体</span></div><div class="line">    <span class="keyword">private</span> String[] colnames; 				<span class="comment">//列名数组</span></div><div class="line">    <span class="keyword">private</span> String[] colTypes; 				<span class="comment">//列名类型数组</span></div><div class="line">    <span class="keyword">private</span> <span class="keyword">boolean</span> f_util = <span class="keyword">false</span>;			<span class="comment">//是否需要导入包java.util.*</span></div><div class="line">    <span class="comment">//用于查询表的列详情，并读取生成注释</span></div><div class="line">    <span class="keyword">private</span> Statement stm;</div><div class="line">    <span class="keyword">private</span> ResultSet rs;</div><div class="line">    </div><div class="line">    <span class="comment">//数据库连接</span></div><div class="line">    <span class="keyword">private</span> Connection con;</div><div class="line"></div><div class="line">    <span class="comment">/**</span></div><div class="line"><span class="comment">     * 构造函数</span></div><div class="line"><span class="comment">     */</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="title">GenEntity</span><span class="params">()</span></span>&#123;</div><div class="line">    	<span class="comment">//创建数据库连接</span></div><div class="line">    	con = connectionDB();</div><div class="line">    	<span class="keyword">try</span> &#123;</div><div class="line">            <span class="comment">/**</span></div><div class="line"><span class="comment">             * 以下提供两种生成方法，使用其中一种请注释另一种</span></div><div class="line"><span class="comment">             */</span></div><div class="line">            <span class="comment">//①此处可以自定定义需要生成的实体类表名，数组形式</span></div><div class="line">            String[] arr = <span class="keyword">new</span> String[]&#123;<span class="string">"attr_name"</span>, <span class="string">"attr_value"</span>&#125;;</div><div class="line">            <span class="keyword">for</span>(String str : arr)&#123;</div><div class="line">                <span class="comment">//开始生成实体类</span></div><div class="line">                <span class="keyword">this</span>.init(str, <span class="keyword">null</span>);</div><div class="line">            &#125;</div><div class="line">        	</div><div class="line">            <span class="comment">//②initAll,将数据库中所有表都生成[***Entity.java]</span></div><div class="line">            <span class="comment">//this.initAll();</span></div><div class="line">        	</div><div class="line">    	&#125; <span class="keyword">catch</span> (Exception e)&#123;</div><div class="line">            e.printStackTrace();</div><div class="line">    	&#125; <span class="keyword">finally</span> &#123;</div><div class="line">            <span class="keyword">try</span> &#123;</div><div class="line">                <span class="comment">//关闭数据库连接</span></div><div class="line">                con.close();</div><div class="line">            &#125; <span class="keyword">catch</span> (SQLException e) &#123;</div><div class="line">                e.printStackTrace();</div><div class="line">            &#125;</div><div class="line">    	&#125;</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    <span class="comment">/**</span></div><div class="line"><span class="comment">     * <span class="doctag">@Title</span>: main </span></div><div class="line"><span class="comment">     * <span class="doctag">@param</span> args    </span></div><div class="line"><span class="comment">     * <span class="doctag">@return</span> void</span></div><div class="line"><span class="comment">     */</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</div><div class="line">        System.out.println(<span class="string">"Init.."</span>);</div><div class="line">    	<span class="keyword">new</span> GenEntity();</div><div class="line">    	System.out.println(<span class="string">"Init Complete.."</span>);</div><div class="line">    &#125;</div><div class="line"></div><div class="line"></div><div class="line">    <span class="comment">/**</span></div><div class="line"><span class="comment">     * <span class="doctag">@param</span> tablename 表名</span></div><div class="line"><span class="comment">     * <span class="doctag">@param</span> notes 注释,该参数为缺省字段，null就会去查询</span></div><div class="line"><span class="comment">     * <span class="doctag">@return</span> </span></div><div class="line"><span class="comment">     */</span></div><div class="line">    <span class="meta">@SuppressWarnings</span>(<span class="string">"unused"</span>)</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">init</span><span class="params">(String tablename, String notes)</span></span>&#123;</div><div class="line">    	<span class="keyword">try</span> &#123;</div><div class="line">            <span class="comment">//查询要生成实体类的表</span></div><div class="line">            String sql = <span class="string">"show full columns from `"</span> + tablename + <span class="string">"`"</span>;</div><div class="line">        	</div><div class="line">            <span class="comment">//执行查询，并获取结果</span></div><div class="line">            stm = con.createStatement();</div><div class="line">            rs = stm.executeQuery(sql);</div><div class="line">            <span class="comment">//统计行数,一行就是一个字段</span></div><div class="line">        	</div><div class="line">            rs.last();<span class="comment">//移到最后一行</span></div><div class="line">            <span class="keyword">int</span> size = rs.getRow();   </div><div class="line">            rs.beforeFirst();<span class="comment">//如果还要用结果集，就把指针再移到初始化的位置  </span></div><div class="line">        	</div><div class="line">            colnames = <span class="keyword">new</span> String[size];</div><div class="line">            colTypes = <span class="keyword">new</span> String[size];</div><div class="line">            <span class="comment">//读取查询的结果集</span></div><div class="line">            <span class="keyword">int</span> i = <span class="number">0</span>;</div><div class="line">            <span class="keyword">while</span>(rs.next())&#123;</div><div class="line">                <span class="comment">//将列名和对应数据类型存入数组</span></div><div class="line">                colnames[i] = rs.getString(<span class="string">"Field"</span>);</div><div class="line">                colTypes[i] = rs.getString(<span class="string">"Type"</span>).replaceAll(<span class="string">"[(].*[)]"</span>, <span class="string">""</span>);</div><div class="line">                <span class="comment">//判断数据类型是否需要引入Util</span></div><div class="line">                <span class="keyword">if</span>(colTypes[i].equalsIgnoreCase(<span class="string">"datetime"</span>)) f_util = <span class="keyword">true</span>;</div><div class="line">                </div><div class="line">                i++;</div><div class="line">            &#125;</div><div class="line">            <span class="comment">//判断是否传递了注释,没有就去查询</span></div><div class="line">            <span class="keyword">if</span>(notes == <span class="keyword">null</span>)&#123;</div><div class="line">                notes = <span class="keyword">this</span>.queryTableNotes(tablename).toString();</div><div class="line">            &#125;</div><div class="line">            <span class="comment">//拼装实体类内容</span></div><div class="line">            String content = parse(colnames, colTypes, tablename, notes);</div><div class="line">            <span class="keyword">try</span> &#123;</div><div class="line">                File directory = <span class="keyword">new</span> File(<span class="string">""</span>);</div><div class="line">                String path = <span class="keyword">this</span>.getClass().getResource(<span class="string">""</span>).getPath();</div><div class="line">                <span class="comment">//设置文件输出路径</span></div><div class="line">                <span class="keyword">if</span>(PATH == <span class="string">""</span>)&#123;</div><div class="line">                    path = directory.getAbsolutePath() + <span class="string">"\\src\\main\\java\\"</span> + path.substring(path.lastIndexOf(<span class="string">"com/"</span>, path.length()), path.length()).replace(<span class="string">"/"</span>, <span class="string">"\\"</span>);</div><div class="line">                &#125;<span class="keyword">else</span>&#123;</div><div class="line">                    path = PATH;</div><div class="line">                &#125;</div><div class="line">                <span class="comment">//文件写入</span></div><div class="line">                FileWriter fw = <span class="keyword">new</span> FileWriter(path + initcap(tablename) + <span class="string">"Entity.java"</span>);</div><div class="line">                PrintWriter pw = <span class="keyword">new</span> PrintWriter(fw);</div><div class="line">                pw.println(content);</div><div class="line">                pw.flush();</div><div class="line">                pw.close();</div><div class="line">            &#125; <span class="keyword">catch</span> (Exception ex)&#123;</div><div class="line">                ex.printStackTrace();</div><div class="line">            &#125;</div><div class="line">        &#125; <span class="keyword">catch</span> (Exception e)&#123;</div><div class="line">            e.printStackTrace();</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="comment">/**</span></div><div class="line"><span class="comment">     * <span class="doctag">@Title</span>: initAll </span></div><div class="line"><span class="comment">     * <span class="doctag">@Description</span>: 初始化生成所有数据库表对应的Entity</span></div><div class="line"><span class="comment">     * <span class="doctag">@return</span> void</span></div><div class="line"><span class="comment">     * <span class="doctag">@throws</span></span></div><div class="line"><span class="comment">     */</span></div><div class="line">    <span class="meta">@SuppressWarnings</span>(<span class="string">"unchecked"</span>)</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">initAll</span><span class="params">()</span></span>&#123;</div><div class="line">        <span class="comment">//查询所有表表名和注释</span></div><div class="line">        Map&lt;String, String&gt; table_notes = (Map&lt;String, String&gt;) queryTableNotes(<span class="keyword">null</span>);</div><div class="line">        <span class="comment">//非空校验</span></div><div class="line">    	<span class="keyword">if</span>(table_notes != <span class="keyword">null</span>)&#123;</div><div class="line">            <span class="keyword">for</span> (Map.Entry&lt;String, String&gt; entry : table_notes.entrySet()) &#123; </div><div class="line">                <span class="comment">//开始生成实体类</span></div><div class="line">                <span class="keyword">this</span>.init(entry.getKey(), entry.getValue());</div><div class="line">            &#125;</div><div class="line">    	&#125;</div><div class="line">    &#125;</div><div class="line">true</div><div class="line">    <span class="comment">/**</span></div><div class="line"><span class="comment">     * 功能：生成实体类主体代码</span></div><div class="line"><span class="comment">     * <span class="doctag">@param</span> colnames</span></div><div class="line"><span class="comment">     * <span class="doctag">@param</span> colTypes</span></div><div class="line"><span class="comment">     * <span class="doctag">@param</span> colSizes </span></div><div class="line"><span class="comment">     * <span class="doctag">@param</span> tablename 表名</span></div><div class="line"><span class="comment">     * <span class="doctag">@return</span> 实体类主体代码字符串</span></div><div class="line"><span class="comment">     * <span class="doctag">@throws</span> SQLException </span></div><div class="line"><span class="comment">     */</span></div><div class="line">    <span class="function"><span class="keyword">private</span> String <span class="title">parse</span><span class="params">(String[] colnames, String[] colTypes, String tablename, String notes)</span> <span class="keyword">throws</span> SQLException </span>&#123;</div><div class="line">        String entity = initcap(tablename);</div><div class="line">    	StringBuffer sb = <span class="keyword">new</span> StringBuffer();</div><div class="line"></div><div class="line">        String path = <span class="keyword">this</span>.getClass().getResource(<span class="string">""</span>).getPath();</div><div class="line">        <span class="comment">//获取包名</span></div><div class="line">        PACKAGE = PACKAGE != <span class="string">""</span>?PACKAGE:path.substring(path.lastIndexOf(<span class="string">"com/"</span>, path.length()), path.length()-<span class="number">1</span>).replace(<span class="string">"/"</span>, <span class="string">"."</span>);</div><div class="line">        <span class="comment">//写入包名和依赖类</span></div><div class="line">        sb.append(<span class="string">"package "</span>+ PACKAGE +<span class="string">";\r\n\r\n"</span>);</div><div class="line">        sb.append(<span class="string">"import com.nmore.smile.base.BaseEntity;\r\n"</span>);</div><div class="line">        <span class="comment">//判断是否导入工具包</span></div><div class="line">        <span class="keyword">if</span>(f_util)&#123;</div><div class="line">            sb.append(<span class="string">"import java.util.Date;\r\n"</span>);</div><div class="line">            f_util = <span class="keyword">false</span>;</div><div class="line">        &#125;</div><div class="line">        </div><div class="line">        sb.append(<span class="string">"\r\n"</span>);</div><div class="line">        <span class="comment">//注释部分</span></div><div class="line">        sb.append(<span class="string">"/**\r\n"</span>);</div><div class="line">        sb.append(<span class="string">"* @ClassName: "</span>+ entity +<span class="string">" \r\n"</span>);</div><div class="line">        sb.append(<span class="string">"* @Description: "</span>+ notes +<span class="string">" \r\n"</span>);</div><div class="line">        sb.append(<span class="string">"* @Author devfzm@gmail.com \r\n"</span>);</div><div class="line">        sb.append(<span class="string">"* @Date "</span>+ <span class="keyword">new</span> Date() +<span class="string">" \r\n"</span>);</div><div class="line">        sb.append(<span class="string">"*/\r\n"</span>);</div><div class="line">        <span class="comment">//实体部分</span></div><div class="line">        sb.append(<span class="string">"\r\n@SuppressWarnings(\"serial\")\r\npublic class "</span> + initcap(tablename) + <span class="string">"Entity extends BaseEntity &#123;\r\n"</span>);</div><div class="line">        processAllAttrs(sb);<span class="comment">//属性</span></div><div class="line">        processAllMethod(sb);<span class="comment">//get set方法</span></div><div class="line">        sb.append(<span class="string">"&#125;\r\n"</span>);</div><div class="line">        </div><div class="line">        <span class="keyword">return</span> sb.toString();</div><div class="line">    &#125;</div><div class="line">    <span class="comment">/**</span></div><div class="line"><span class="comment">     * 功能：生成所有属性和对应注释</span></div><div class="line"><span class="comment">     * <span class="doctag">@param</span> sb</span></div><div class="line"><span class="comment">     * <span class="doctag">@throws</span> SQLException </span></div><div class="line"><span class="comment">     */</span></div><div class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">processAllAttrs</span><span class="params">(StringBuffer sb)</span> <span class="keyword">throws</span> SQLException </span>&#123;</div><div class="line">    	<span class="keyword">int</span> i = <span class="number">0</span>;</div><div class="line">    	rs.beforeFirst();<span class="comment">//如果还要用结果集，就把指针再移到初始化的位置</span></div><div class="line">        <span class="keyword">while</span>(rs.next()) &#123;</div><div class="line">            sb.append(<span class="string">"\t//"</span> + rs.getString(<span class="string">"Comment"</span>));</div><div class="line">            sb.append(<span class="string">"\n\tprivate "</span> + sqlType2JavaType(colTypes[i]) + <span class="string">" "</span> + colnames[i] + <span class="string">";\r\n"</span>);</div><div class="line">            i++;</div><div class="line">        &#125;</div><div class="line">        sb.append(<span class="string">"\r\n"</span>);</div><div class="line">        rs.close();</div><div class="line">        stm.close();</div><div class="line">    &#125;</div><div class="line"> </div><div class="line">    <span class="comment">/**</span></div><div class="line"><span class="comment">     * 功能：生成所有 Getter/Setter 方法</span></div><div class="line"><span class="comment">     * <span class="doctag">@param</span> sb</span></div><div class="line"><span class="comment">     */</span></div><div class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">processAllMethod</span><span class="params">(StringBuffer sb)</span> </span>&#123;</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; colnames.length; i++) &#123;</div><div class="line">            sb.append(<span class="string">"\tpublic void set"</span> + initcap(colnames[i]) + <span class="string">"("</span> + sqlType2JavaType(colTypes[i]) + <span class="string">" "</span> + </div><div class="line">                    colnames[i] + <span class="string">")&#123;\r\n"</span>);</div><div class="line">            sb.append(<span class="string">"\t\tthis."</span> + colnames[i] + <span class="string">"="</span> + colnames[i] + <span class="string">";\r\n"</span>);</div><div class="line">            sb.append(<span class="string">"\t&#125;\r\n"</span>);</div><div class="line">            sb.append(<span class="string">"\tpublic "</span> + sqlType2JavaType(colTypes[i]) + <span class="string">" get"</span> + initcap(colnames[i]) + <span class="string">"()&#123;\r\n"</span>);</div><div class="line">            sb.append(<span class="string">"\t\treturn "</span> + colnames[i] + <span class="string">";\r\n"</span>);</div><div class="line">            sb.append(<span class="string">"\t&#125;\r\n"</span>);</div><div class="line">        &#125;</div><div class="line">         </div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="comment">/**</span></div><div class="line"><span class="comment">     * 功能：获得列的数据类型</span></div><div class="line"><span class="comment">     * <span class="doctag">@param</span> sqlType</span></div><div class="line"><span class="comment">     * <span class="doctag">@return</span> javaType</span></div><div class="line"><span class="comment">     */</span></div><div class="line">    <span class="function"><span class="keyword">private</span> String <span class="title">sqlType2JavaType</span><span class="params">(String sqlType)</span> </span>&#123;</div><div class="line">        <span class="keyword">if</span>(sqlType.equalsIgnoreCase(<span class="string">"bit"</span>))&#123;</div><div class="line">            <span class="keyword">return</span> <span class="string">"Boolean"</span>;</div><div class="line">        &#125;<span class="keyword">else</span> <span class="keyword">if</span>(sqlType.equalsIgnoreCase(<span class="string">"tinyint"</span>))&#123;</div><div class="line">            <span class="keyword">return</span> <span class="string">"byte"</span>;</div><div class="line">        &#125;<span class="keyword">else</span> <span class="keyword">if</span>(sqlType.equalsIgnoreCase(<span class="string">"smallint"</span>))&#123;</div><div class="line">            <span class="keyword">return</span> <span class="string">"short"</span>;</div><div class="line">        &#125;<span class="keyword">else</span> <span class="keyword">if</span>(sqlType.equalsIgnoreCase(<span class="string">"int"</span>))&#123;</div><div class="line">            <span class="keyword">return</span> <span class="string">"Integer"</span>;</div><div class="line">        &#125;<span class="keyword">else</span> <span class="keyword">if</span>(sqlType.equalsIgnoreCase(<span class="string">"bigint"</span>))&#123;</div><div class="line">            <span class="keyword">return</span> <span class="string">"long"</span>;</div><div class="line">        &#125;<span class="keyword">else</span> <span class="keyword">if</span>(sqlType.equalsIgnoreCase(<span class="string">"float"</span>))&#123;</div><div class="line">            <span class="keyword">return</span> <span class="string">"float"</span>;</div><div class="line">        &#125;<span class="keyword">else</span> <span class="keyword">if</span>(sqlType.equalsIgnoreCase(<span class="string">"decimal"</span>) || sqlType.equalsIgnoreCase(<span class="string">"numeric"</span>) </div><div class="line">                || sqlType.equalsIgnoreCase(<span class="string">"real"</span>) || sqlType.equalsIgnoreCase(<span class="string">"money"</span>) </div><div class="line">                || sqlType.equalsIgnoreCase(<span class="string">"smallmoney"</span>))&#123;</div><div class="line">            <span class="keyword">return</span> <span class="string">"Double"</span>;</div><div class="line">        &#125;<span class="keyword">else</span> <span class="keyword">if</span>(sqlType.equalsIgnoreCase(<span class="string">"varchar"</span>) || sqlType.equalsIgnoreCase(<span class="string">"char"</span>) </div><div class="line">                || sqlType.equalsIgnoreCase(<span class="string">"nvarchar"</span>) || sqlType.equalsIgnoreCase(<span class="string">"nchar"</span>) </div><div class="line">                || sqlType.equalsIgnoreCase(<span class="string">"text"</span>))&#123;</div><div class="line">            <span class="keyword">return</span> <span class="string">"String"</span>;</div><div class="line">        &#125;<span class="keyword">else</span> <span class="keyword">if</span>(sqlType.equalsIgnoreCase(<span class="string">"datetime"</span>))&#123;</div><div class="line">            <span class="keyword">return</span> <span class="string">"Date"</span>;</div><div class="line">        &#125;<span class="keyword">else</span> <span class="keyword">if</span>(sqlType.equalsIgnoreCase(<span class="string">"image"</span>))&#123;</div><div class="line">            <span class="keyword">return</span> <span class="string">"Blod"</span>;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> <span class="keyword">null</span>;</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    <span class="comment">/**</span></div><div class="line"><span class="comment">     * 功能：将输入字符串的首字母和"_a"格式的字母改成大写</span></div><div class="line"><span class="comment">     * <span class="doctag">@param</span> str</span></div><div class="line"><span class="comment">     * <span class="doctag">@return</span></span></div><div class="line"><span class="comment">     */</span></div><div class="line">    <span class="function"><span class="keyword">private</span> String <span class="title">initcap</span><span class="params">(String str)</span> </span>&#123;</div><div class="line">        <span class="keyword">char</span>[] ch = str.toCharArray();</div><div class="line">    	<span class="keyword">if</span>(ch[<span class="number">0</span>] &gt;= <span class="string">'a'</span> &amp;&amp; ch[<span class="number">0</span>] &lt;= <span class="string">'z'</span>)&#123;</div><div class="line">            ch[<span class="number">0</span>] = (<span class="keyword">char</span>)(ch[<span class="number">0</span>] - <span class="number">32</span>);</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> <span class="keyword">new</span> String(ch);</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    <span class="comment">/**</span></div><div class="line"><span class="comment">     * <span class="doctag">@Title</span>: queryTableNotes </span></div><div class="line"><span class="comment">     * <span class="doctag">@Description</span>: 查询表注释</span></div><div class="line"><span class="comment">     * <span class="doctag">@param</span> tableName 该参数为缺省参数，不传默认查询所有表</span></div><div class="line"><span class="comment">     * <span class="doctag">@return</span> Object</span></div><div class="line"><span class="comment">     * <span class="doctag">@throws</span></span></div><div class="line"><span class="comment">     */</span></div><div class="line">    <span class="function"><span class="keyword">public</span> Object <span class="title">queryTableNotes</span><span class="params">(String tableName)</span></span>&#123;</div><div class="line">    	<span class="keyword">try</span> &#123;</div><div class="line">            <span class="comment">//查询表名称和注释,默认查询数据库的全部表（即tableName为null时）</span></div><div class="line">            String sql = <span class="string">"select table_name,table_comment from information_schema.`TABLES` WHERE table_schema = '"</span>+ DATABASE +<span class="string">"'"</span>;</div><div class="line">            <span class="keyword">if</span>(tableName != <span class="keyword">null</span>)&#123;</div><div class="line">                sql += <span class="string">" and table_name='"</span>+ tableName +<span class="string">"'"</span>;</div><div class="line">            &#125;</div><div class="line">            <span class="comment">//执行查询，并获取结果</span></div><div class="line">            Statement sta = con.createStatement();</div><div class="line">            ResultSet rst = sta.executeQuery(sql);</div><div class="line">            <span class="comment">//读取查询结果</span></div><div class="line">            <span class="keyword">if</span>(tableName != <span class="keyword">null</span>)&#123;</div><div class="line">                String str = <span class="string">""</span>; </div><div class="line">            	<span class="keyword">while</span>(rst.next())&#123;</div><div class="line">                    str = rst.getString(<span class="string">"table_comment"</span>);</div><div class="line">            	&#125;</div><div class="line">                sta.close();</div><div class="line">                rst.close();</div><div class="line">                <span class="keyword">return</span> str;</div><div class="line">            &#125;<span class="keyword">else</span>&#123;</div><div class="line">                Map&lt;String, String&gt; map = <span class="keyword">new</span> HashMap&lt;String, String&gt;();</div><div class="line">            	<span class="keyword">while</span>(rst.next())&#123;</div><div class="line">                    map.put(rst.getString(<span class="string">"table_name"</span>), rst.getString(<span class="string">"table_comment"</span>));</div><div class="line">            	&#125;</div><div class="line">            	sta.close();</div><div class="line">                rst.close();</div><div class="line">            	<span class="keyword">return</span> map;</div><div class="line">            &#125;</div><div class="line">    	&#125; <span class="keyword">catch</span> (Exception e)&#123;</div><div class="line">            e.printStackTrace();</div><div class="line">            <span class="keyword">return</span> <span class="keyword">null</span>;</div><div class="line">    	&#125;</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    <span class="comment">/**</span></div><div class="line"><span class="comment">     * 建立数据的连接</span></div><div class="line"><span class="comment">     * <span class="doctag">@exception</span> SQLException, ClassNotFoundException</span></div><div class="line"><span class="comment">     */</span></div><div class="line">    <span class="function"><span class="keyword">public</span> Connection <span class="title">connectionDB</span><span class="params">()</span></span>&#123;</div><div class="line">        <span class="keyword">try</span>&#123;</div><div class="line">            Class.forName(DRIVER);</div><div class="line">            Connection conn = DriverManager.getConnection(URL, NAME, PASS);</div><div class="line">            <span class="comment">//System.out.println("连接数据库成功");</span></div><div class="line">            <span class="keyword">return</span> conn;</div><div class="line">        &#125;<span class="keyword">catch</span>(Exception e)&#123;</div><div class="line">            e.printStackTrace();</div><div class="line">            <span class="comment">//System.out.println("建立数据库发生错误！");</span></div><div class="line">            <span class="keyword">return</span> <span class="keyword">null</span>;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line"> </div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
</div></article></div></main><footer><div class="paginator"><a href="/2017/09/02/show/" class="prev">上一篇</a><a href="/2017/09/02/html-escape/" class="next">下一篇</a></div><div class="copyright"><p>© 2015 - 2017 <a href="http://blog.ifzm.cn">ifzm</a>, powered by <a href="https://hexo.io/" target="_blank">Hexo</a> and <a href="https://github.com/pinggod/hexo-theme-apollo" target="_blank">hexo-theme-apollo</a>.</p></div></footer></div><script async src="//cdn.bootcss.com/mathjax/2.7.0/MathJax.js?config=TeX-MML-AM_CHTML" integrity="sha384-crwIf/BuaWM9rM65iM+dWFldgQ1Un8jWZMuh3puxb8TOY9+linwLoI7ZHZT+aekW" crossorigin="anonymous"></script><script>(function(b,o,i,l,e,r){b.GoogleAnalyticsObject=l;b[l]||(b[l]=function(){(b[l].q=b[l].q||[]).push(arguments)});b[l].l=+new Date;e=o.createElement(i);r=o.getElementsByTagName(i)[0];e.src='//www.google-analytics.com/analytics.js';r.parentNode.insertBefore(e,r)}(window,document,'script','ga'));ga('create',"UA-65933410-1",'auto');ga('send','pageview');</script></body></html>