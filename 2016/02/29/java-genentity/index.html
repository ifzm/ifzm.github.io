<!DOCTYPE html><html><head><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><title> Java 数据库表生成 Entity 工具类 · Smile Blog</title><meta name="description" content="这是一个整理出来的JAVA工具类，用于将MySQL数据库表生成Entity实体类1234567891011121314&lt;span cl"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="icon" href="/favicon.ico"><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:400,600"><link rel="stylesheet" href="/css/fontawesome/font-awesome.min.css"><link rel="stylesheet" href="/css/apollo.css"><link rel="stylesheet" href="/css/style.css"><script src="/js/jquery-2.2.0.min.js"></script></head><body><header><a href="/" class="logo-link"><img src="/favicon.png"></a><ul class="nav nav-list"><li class="nav-list-item"><a href="/" target="_self" class="nav-list-link"><i class="fa-globe fa mr3"> </i>Blog</a></li><li class="nav-list-item"><a href="/archives" target="_self" class="nav-list-link"><i class="fa-yelp fa mr3"> </i>Archives</a></li><li class="nav-list-item"><a href="/atom.xml" target="_self" class="nav-list-link"><i class="fa-rss fa mr3"> </i>RSS</a></li></ul></header><section class="container"><div class="post"><article class="post-block"><h1 class="post-title">Java 数据库表生成 Entity 工具类</h1><div class="post-meta"><div class="post-time"> <span class="time"><i class="fa fa-calendar"></i>Feb 29, 2016</span><span class="tags"><i class="fa fa-tags"></i><a href="/tags/Entity" class="nav-list-link">Entity</a>,<a href="/tags/Java" class="nav-list-link">Java</a>,<a href="/tags/MySQL" class="nav-list-link">MySQL</a></span><span id="/2016/02/29/java-genentity/" data-title="Java 数据库表生成 Entity 工具类" class="visitors"><i class="fa fa-eye"></i><span> </span></span></div></div><div class="post-content"><p><div class="tip">这是一个整理出来的JAVA工具类，用于将MySQL数据库表生成Entity实体类</div><a id="more"></a><br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.nmore.smile.utils;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.File;</span><br><span class="line"><span class="keyword">import</span> java.io.FileWriter;</span><br><span class="line"><span class="keyword">import</span> java.io.PrintWriter;</span><br><span class="line"><span class="keyword">import</span> java.sql.Connection;</span><br><span class="line"><span class="keyword">import</span> java.sql.DriverManager;</span><br><span class="line"><span class="keyword">import</span> java.sql.ResultSet;</span><br><span class="line"><span class="keyword">import</span> java.sql.SQLException;</span><br><span class="line"><span class="keyword">import</span> java.sql.Statement;</span><br><span class="line"><span class="keyword">import</span> java.util.Date;</span><br><span class="line"><span class="keyword">import</span> java.util.HashMap;</span><br><span class="line"><span class="keyword">import</span> java.util.Map;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span><br><span class="line"> * <span class="doctag">@ClassName</span>: GenEntity </span><br><span class="line"> * <span class="doctag">@Description</span>: 数据库表生成Entity工具类</span><br><span class="line"> * <span class="doctag">@author</span> devfzm<span class="doctag">@gmail</span>.com</span><br><span class="line"> * <span class="doctag">@date</span> 2016年2月29日 上午10:13:36 </span><br><span class="line"> *</span><br><span class="line"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">GenEntity</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//输出到自定义目录，为空代表输出到当前目录</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> String PATH = <span class="string">""</span>;</span><br><span class="line">    <span class="comment">//包名(当指定PATH时，请同步修改PACKAGE，为空则默认为当前目录),如:com.nmore.smile.entity</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> String PACKAGE = <span class="string">""</span>;</span><br><span class="line">	</span><br><span class="line">    <span class="comment">//数据库连接</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> String DATABASE = <span class="string">"imall"</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> String URL =<span class="string">"jdbc:mysql://localhost:3306/"</span>+ DATABASE +<span class="string">"?useUnicode=true&amp;characterEncoding=UTF8&amp;useSSL=false"</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> String NAME = <span class="string">"root"</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> String PASS = <span class="string">"123456"</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> String DRIVER =<span class="string">"com.mysql.jdbc.Driver"</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//用于生成实体</span></span><br><span class="line">    <span class="keyword">private</span> String[] colnames; 				<span class="comment">//列名数组</span></span><br><span class="line">    <span class="keyword">private</span> String[] colTypes; 				<span class="comment">//列名类型数组</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">boolean</span> f_util = <span class="keyword">false</span>;			<span class="comment">//是否需要导入包java.util.*</span></span><br><span class="line">    <span class="comment">//用于查询表的列详情，并读取生成注释</span></span><br><span class="line">    <span class="keyword">private</span> Statement stm;</span><br><span class="line">    <span class="keyword">private</span> ResultSet rs;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//数据库连接</span></span><br><span class="line">    <span class="keyword">private</span> Connection con;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span><br><span class="line">     * 构造函数</span><br><span class="line">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">GenEntity</span><span class="params">()</span></span>&#123;</span><br><span class="line">    	<span class="comment">//创建数据库连接</span></span><br><span class="line">    	con = connectionDB();</span><br><span class="line">    	<span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="comment">/**</span><br><span class="line">             * 以下提供两种生成方法，使用其中一种请注释另一种</span><br><span class="line">             */</span></span><br><span class="line">            <span class="comment">//①此处可以自定定义需要生成的实体类表名，数组形式</span></span><br><span class="line">            String[] arr = <span class="keyword">new</span> String[]&#123;<span class="string">"attr_name"</span>, <span class="string">"attr_value"</span>&#125;;</span><br><span class="line">            <span class="keyword">for</span>(String str : arr)&#123;</span><br><span class="line">                <span class="comment">//开始生成实体类</span></span><br><span class="line">                <span class="keyword">this</span>.init(str, <span class="keyword">null</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        	</span><br><span class="line">            <span class="comment">//②initAll,将数据库中所有表都生成[***Entity.java]</span></span><br><span class="line">            <span class="comment">//this.initAll();</span></span><br><span class="line">        	</span><br><span class="line">    	&#125; <span class="keyword">catch</span> (Exception e)&#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">    	&#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                <span class="comment">//关闭数据库连接</span></span><br><span class="line">                con.close();</span><br><span class="line">            &#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">                e.printStackTrace();</span><br><span class="line">            &#125;</span><br><span class="line">    	&#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">/**</span><br><span class="line">     * <span class="doctag">@Title</span>: main </span><br><span class="line">     * <span class="doctag">@param</span> args    </span><br><span class="line">     * <span class="doctag">@return</span> void</span><br><span class="line">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"Init.."</span>);</span><br><span class="line">    	<span class="keyword">new</span> GenEntity();</span><br><span class="line">    	System.out.println(<span class="string">"Init Complete.."</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span><br><span class="line">     * <span class="doctag">@param</span> tablename 表名</span><br><span class="line">     * <span class="doctag">@param</span> notes 注释,该参数为缺省字段，null就会去查询</span><br><span class="line">     * <span class="doctag">@return</span> </span><br><span class="line">     */</span></span><br><span class="line">    <span class="annotation">@SuppressWarnings</span>(<span class="string">"unused"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">init</span><span class="params">(String tablename, String notes)</span></span>&#123;</span><br><span class="line">    	<span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="comment">//查询要生成实体类的表</span></span><br><span class="line">            String sql = <span class="string">"show full columns from `"</span> + tablename + <span class="string">"`"</span>;</span><br><span class="line">        	</span><br><span class="line">            <span class="comment">//执行查询，并获取结果</span></span><br><span class="line">            stm = con.createStatement();</span><br><span class="line">            rs = stm.executeQuery(sql);</span><br><span class="line">            <span class="comment">//统计行数,一行就是一个字段</span></span><br><span class="line">        	</span><br><span class="line">            rs.last();<span class="comment">//移到最后一行</span></span><br><span class="line">            <span class="keyword">int</span> size = rs.getRow();   </span><br><span class="line">            rs.beforeFirst();<span class="comment">//如果还要用结果集，就把指针再移到初始化的位置  </span></span><br><span class="line">        	</span><br><span class="line">            colnames = <span class="keyword">new</span> String[size];</span><br><span class="line">            colTypes = <span class="keyword">new</span> String[size];</span><br><span class="line">            <span class="comment">//读取查询的结果集</span></span><br><span class="line">            <span class="keyword">int</span> i = <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">while</span>(rs.next())&#123;</span><br><span class="line">                <span class="comment">//将列名和对应数据类型存入数组</span></span><br><span class="line">                colnames[i] = rs.getString(<span class="string">"Field"</span>);</span><br><span class="line">                colTypes[i] = rs.getString(<span class="string">"Type"</span>).replaceAll(<span class="string">"[(].*[)]"</span>, <span class="string">""</span>);</span><br><span class="line">                <span class="comment">//判断数据类型是否需要引入Util</span></span><br><span class="line">                <span class="keyword">if</span>(colTypes[i].equalsIgnoreCase(<span class="string">"datetime"</span>)) f_util = <span class="keyword">true</span>;</span><br><span class="line">                </span><br><span class="line">                i++;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">//判断是否传递了注释,没有就去查询</span></span><br><span class="line">            <span class="keyword">if</span>(notes == <span class="keyword">null</span>)&#123;</span><br><span class="line">                notes = <span class="keyword">this</span>.queryTableNotes(tablename).toString();</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">//拼装实体类内容</span></span><br><span class="line">            String content = parse(colnames, colTypes, tablename, notes);</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                File directory = <span class="keyword">new</span> File(<span class="string">""</span>);</span><br><span class="line">                String path = <span class="keyword">this</span>.getClass().getResource(<span class="string">""</span>).getPath();</span><br><span class="line">                <span class="comment">//设置文件输出路径</span></span><br><span class="line">                <span class="keyword">if</span>(PATH == <span class="string">""</span>)&#123;</span><br><span class="line">                    path = directory.getAbsolutePath() + <span class="string">"\\src\\main\\java\\"</span> + path.substring(path.lastIndexOf(<span class="string">"com/"</span>, path.length()), path.length()).replace(<span class="string">"/"</span>, <span class="string">"\\"</span>);</span><br><span class="line">                &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                    path = PATH;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="comment">//文件写入</span></span><br><span class="line">                FileWriter fw = <span class="keyword">new</span> FileWriter(path + initcap(tablename) + <span class="string">"Entity.java"</span>);</span><br><span class="line">                PrintWriter pw = <span class="keyword">new</span> PrintWriter(fw);</span><br><span class="line">                pw.println(content);</span><br><span class="line">                pw.flush();</span><br><span class="line">                pw.close();</span><br><span class="line">            &#125; <span class="keyword">catch</span> (Exception ex)&#123;</span><br><span class="line">                ex.printStackTrace();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e)&#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span><br><span class="line">     * <span class="doctag">@Title</span>: initAll </span><br><span class="line">     * <span class="doctag">@Description</span>: 初始化生成所有数据库表对应的Entity</span><br><span class="line">     * <span class="doctag">@return</span> void</span><br><span class="line">     * <span class="doctag">@throws</span></span><br><span class="line">     */</span></span><br><span class="line">    <span class="annotation">@SuppressWarnings</span>(<span class="string">"unchecked"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">initAll</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="comment">//查询所有表表名和注释</span></span><br><span class="line">        Map&lt;String, String&gt; table_notes = (Map&lt;String, String&gt;) queryTableNotes(<span class="keyword">null</span>);</span><br><span class="line">        <span class="comment">//非空校验</span></span><br><span class="line">    	<span class="keyword">if</span>(table_notes != <span class="keyword">null</span>)&#123;</span><br><span class="line">            <span class="keyword">for</span> (Map.Entry&lt;String, String&gt; entry : table_notes.entrySet()) &#123; </span><br><span class="line">                <span class="comment">//开始生成实体类</span></span><br><span class="line">                <span class="keyword">this</span>.init(entry.getKey(), entry.getValue());</span><br><span class="line">            &#125;</span><br><span class="line">    	&#125;</span><br><span class="line">    &#125;</span><br><span class="line">	</span><br><span class="line">    <span class="comment">/**</span><br><span class="line">     * 功能：生成实体类主体代码</span><br><span class="line">     * <span class="doctag">@param</span> colnames</span><br><span class="line">     * <span class="doctag">@param</span> colTypes</span><br><span class="line">     * <span class="doctag">@param</span> colSizes </span><br><span class="line">     * <span class="doctag">@param</span> tablename 表名</span><br><span class="line">     * <span class="doctag">@return</span> 实体类主体代码字符串</span><br><span class="line">     * <span class="doctag">@throws</span> SQLException </span><br><span class="line">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">private</span> String <span class="title">parse</span><span class="params">(String[] colnames, String[] colTypes, String tablename, String notes)</span> <span class="keyword">throws</span> SQLException </span>&#123;</span><br><span class="line">        String entity = initcap(tablename);</span><br><span class="line">    	StringBuffer sb = <span class="keyword">new</span> StringBuffer();</span><br><span class="line"></span><br><span class="line">        String path = <span class="keyword">this</span>.getClass().getResource(<span class="string">""</span>).getPath();</span><br><span class="line">        <span class="comment">//获取包名</span></span><br><span class="line">        PACKAGE = PACKAGE != <span class="string">""</span>?PACKAGE:path.substring(path.lastIndexOf(<span class="string">"com/"</span>, path.length()), path.length()-<span class="number">1</span>).replace(<span class="string">"/"</span>, <span class="string">"."</span>);</span><br><span class="line">        <span class="comment">//写入包名和依赖类</span></span><br><span class="line">        sb.append(<span class="string">"package "</span>+ PACKAGE +<span class="string">";\r\n\r\n"</span>);</span><br><span class="line">        sb.append(<span class="string">"import com.nmore.smile.base.BaseEntity;\r\n"</span>);</span><br><span class="line">        <span class="comment">//判断是否导入工具包</span></span><br><span class="line">        <span class="keyword">if</span>(f_util)&#123;</span><br><span class="line">            sb.append(<span class="string">"import java.util.Date;\r\n"</span>);</span><br><span class="line">            f_util = <span class="keyword">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        sb.append(<span class="string">"\r\n"</span>);</span><br><span class="line">        <span class="comment">//注释部分</span></span><br><span class="line">        sb.append(<span class="string">"/**\r\n"</span>);</span><br><span class="line">        sb.append(<span class="string">"* @ClassName: "</span>+ entity +<span class="string">" \r\n"</span>);</span><br><span class="line">        sb.append(<span class="string">"* @Description: "</span>+ notes +<span class="string">" \r\n"</span>);</span><br><span class="line">        sb.append(<span class="string">"* @author devfzm@gmail.com \r\n"</span>);</span><br><span class="line">        sb.append(<span class="string">"* @date "</span>+ <span class="keyword">new</span> Date() +<span class="string">" \r\n"</span>);</span><br><span class="line">        sb.append(<span class="string">"*/\r\n"</span>);</span><br><span class="line">        <span class="comment">//实体部分</span></span><br><span class="line">        sb.append(<span class="string">"\r\n@SuppressWarnings(\"serial\")\r\npublic class "</span> + initcap(tablename) + <span class="string">"Entity extends BaseEntity &#123;\r\n"</span>);</span><br><span class="line">        processAllAttrs(sb);<span class="comment">//属性</span></span><br><span class="line">        processAllMethod(sb);<span class="comment">//get set方法</span></span><br><span class="line">        sb.append(<span class="string">"&#125;\r\n"</span>);</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">return</span> sb.toString();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/**</span><br><span class="line">     * 功能：生成所有属性和对应注释</span><br><span class="line">     * <span class="doctag">@param</span> sb</span><br><span class="line">     * <span class="doctag">@throws</span> SQLException </span><br><span class="line">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">processAllAttrs</span><span class="params">(StringBuffer sb)</span> <span class="keyword">throws</span> SQLException </span>&#123;</span><br><span class="line">    	<span class="keyword">int</span> i = <span class="number">0</span>;</span><br><span class="line">    	rs.beforeFirst();<span class="comment">//如果还要用结果集，就把指针再移到初始化的位置</span></span><br><span class="line">        <span class="keyword">while</span>(rs.next()) &#123;</span><br><span class="line">            sb.append(<span class="string">"\t//"</span> + rs.getString(<span class="string">"Comment"</span>));</span><br><span class="line">            sb.append(<span class="string">"\n\tprivate "</span> + sqlType2JavaType(colTypes[i]) + <span class="string">" "</span> + colnames[i] + <span class="string">";\r\n"</span>);</span><br><span class="line">            i++;</span><br><span class="line">        &#125;</span><br><span class="line">        sb.append(<span class="string">"\r\n"</span>);</span><br><span class="line">        rs.close();</span><br><span class="line">        stm.close();</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="comment">/**</span><br><span class="line">     * 功能：生成所有 Getter/Setter 方法</span><br><span class="line">     * <span class="doctag">@param</span> sb</span><br><span class="line">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">processAllMethod</span><span class="params">(StringBuffer sb)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; colnames.length; i++) &#123;</span><br><span class="line">            sb.append(<span class="string">"\tpublic void set"</span> + initcap(colnames[i]) + <span class="string">"("</span> + sqlType2JavaType(colTypes[i]) + <span class="string">" "</span> + </span><br><span class="line">                    colnames[i] + <span class="string">")&#123;\r\n"</span>);</span><br><span class="line">            sb.append(<span class="string">"\t\tthis."</span> + colnames[i] + <span class="string">"="</span> + colnames[i] + <span class="string">";\r\n"</span>);</span><br><span class="line">            sb.append(<span class="string">"\t&#125;\r\n"</span>);</span><br><span class="line">            sb.append(<span class="string">"\tpublic "</span> + sqlType2JavaType(colTypes[i]) + <span class="string">" get"</span> + initcap(colnames[i]) + <span class="string">"()&#123;\r\n"</span>);</span><br><span class="line">            sb.append(<span class="string">"\t\treturn "</span> + colnames[i] + <span class="string">";\r\n"</span>);</span><br><span class="line">            sb.append(<span class="string">"\t&#125;\r\n"</span>);</span><br><span class="line">        &#125;</span><br><span class="line">         </span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span><br><span class="line">     * 功能：获得列的数据类型</span><br><span class="line">     * <span class="doctag">@param</span> sqlType</span><br><span class="line">     * <span class="doctag">@return</span> javaType</span><br><span class="line">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">private</span> String <span class="title">sqlType2JavaType</span><span class="params">(String sqlType)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(sqlType.equalsIgnoreCase(<span class="string">"bit"</span>))&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="string">"Boolean"</span>;</span><br><span class="line">        &#125;<span class="keyword">else</span> <span class="keyword">if</span>(sqlType.equalsIgnoreCase(<span class="string">"tinyint"</span>))&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="string">"byte"</span>;</span><br><span class="line">        &#125;<span class="keyword">else</span> <span class="keyword">if</span>(sqlType.equalsIgnoreCase(<span class="string">"smallint"</span>))&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="string">"short"</span>;</span><br><span class="line">        &#125;<span class="keyword">else</span> <span class="keyword">if</span>(sqlType.equalsIgnoreCase(<span class="string">"int"</span>))&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="string">"Integer"</span>;</span><br><span class="line">        &#125;<span class="keyword">else</span> <span class="keyword">if</span>(sqlType.equalsIgnoreCase(<span class="string">"bigint"</span>))&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="string">"long"</span>;</span><br><span class="line">        &#125;<span class="keyword">else</span> <span class="keyword">if</span>(sqlType.equalsIgnoreCase(<span class="string">"float"</span>))&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="string">"float"</span>;</span><br><span class="line">        &#125;<span class="keyword">else</span> <span class="keyword">if</span>(sqlType.equalsIgnoreCase(<span class="string">"decimal"</span>) || sqlType.equalsIgnoreCase(<span class="string">"numeric"</span>) </span><br><span class="line">                || sqlType.equalsIgnoreCase(<span class="string">"real"</span>) || sqlType.equalsIgnoreCase(<span class="string">"money"</span>) </span><br><span class="line">                || sqlType.equalsIgnoreCase(<span class="string">"smallmoney"</span>))&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="string">"Double"</span>;</span><br><span class="line">        &#125;<span class="keyword">else</span> <span class="keyword">if</span>(sqlType.equalsIgnoreCase(<span class="string">"varchar"</span>) || sqlType.equalsIgnoreCase(<span class="string">"char"</span>) </span><br><span class="line">                || sqlType.equalsIgnoreCase(<span class="string">"nvarchar"</span>) || sqlType.equalsIgnoreCase(<span class="string">"nchar"</span>) </span><br><span class="line">                || sqlType.equalsIgnoreCase(<span class="string">"text"</span>))&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="string">"String"</span>;</span><br><span class="line">        &#125;<span class="keyword">else</span> <span class="keyword">if</span>(sqlType.equalsIgnoreCase(<span class="string">"datetime"</span>))&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="string">"Date"</span>;</span><br><span class="line">        &#125;<span class="keyword">else</span> <span class="keyword">if</span>(sqlType.equalsIgnoreCase(<span class="string">"image"</span>))&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="string">"Blod"</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">/**</span><br><span class="line">     * 功能：将输入字符串的首字母和"_a"格式的字母改成大写</span><br><span class="line">     * <span class="doctag">@param</span> str</span><br><span class="line">     * <span class="doctag">@return</span></span><br><span class="line">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">private</span> String <span class="title">initcap</span><span class="params">(String str)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">char</span>[] ch = str.toCharArray();</span><br><span class="line">    	<span class="keyword">if</span>(ch[<span class="number">0</span>] &gt;= <span class="string">'a'</span> &amp;&amp; ch[<span class="number">0</span>] &lt;= <span class="string">'z'</span>)&#123;</span><br><span class="line">            ch[<span class="number">0</span>] = (<span class="keyword">char</span>)(ch[<span class="number">0</span>] - <span class="number">32</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; ch.length; i++)&#123;</span><br><span class="line">            <span class="keyword">if</span>(ch[i] == <span class="string">'_'</span> &amp;&amp; ch[i+<span class="number">1</span>] &gt;= <span class="string">'a'</span> &amp;&amp; ch[i+<span class="number">1</span>] &lt;= <span class="string">'z'</span>)&#123;</span><br><span class="line">                ch[i+<span class="number">1</span>] = (<span class="keyword">char</span>)(ch[i+<span class="number">1</span>] - <span class="number">32</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> String(ch);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">/**</span><br><span class="line">     * <span class="doctag">@Title</span>: queryTableNotes </span><br><span class="line">     * <span class="doctag">@Description</span>: 查询表注释</span><br><span class="line">     * <span class="doctag">@param</span> tableName 该参数为缺省参数，不传默认查询所有表</span><br><span class="line">     * <span class="doctag">@return</span> Object</span><br><span class="line">     * <span class="doctag">@throws</span></span><br><span class="line">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Object <span class="title">queryTableNotes</span><span class="params">(String tableName)</span></span>&#123;</span><br><span class="line">    	<span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="comment">//查询表名称和注释,默认查询数据库的全部表（即tableName为null时）</span></span><br><span class="line">            String sql = <span class="string">"select table_name,table_comment from information_schema.`TABLES` WHERE table_schema = '"</span>+ DATABASE +<span class="string">"'"</span>;</span><br><span class="line">            <span class="keyword">if</span>(tableName != <span class="keyword">null</span>)&#123;</span><br><span class="line">                sql += <span class="string">" and table_name='"</span>+ tableName +<span class="string">"'"</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">//执行查询，并获取结果</span></span><br><span class="line">            Statement sta = con.createStatement();</span><br><span class="line">            ResultSet rst = sta.executeQuery(sql);</span><br><span class="line">            <span class="comment">//读取查询结果</span></span><br><span class="line">            <span class="keyword">if</span>(tableName != <span class="keyword">null</span>)&#123;</span><br><span class="line">                String str = <span class="string">""</span>; </span><br><span class="line">            	<span class="keyword">while</span>(rst.next())&#123;</span><br><span class="line">                    str = rst.getString(<span class="string">"table_comment"</span>);</span><br><span class="line">            	&#125;</span><br><span class="line">                sta.close();</span><br><span class="line">                rst.close();</span><br><span class="line">                <span class="keyword">return</span> str;</span><br><span class="line">            &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                Map&lt;String, String&gt; map = <span class="keyword">new</span> HashMap&lt;String, String&gt;();</span><br><span class="line">            	<span class="keyword">while</span>(rst.next())&#123;</span><br><span class="line">                    map.put(rst.getString(<span class="string">"table_name"</span>), rst.getString(<span class="string">"table_comment"</span>));</span><br><span class="line">            	&#125;</span><br><span class="line">            	sta.close();</span><br><span class="line">                rst.close();</span><br><span class="line">            	<span class="keyword">return</span> map;</span><br><span class="line">            &#125;</span><br><span class="line">    	&#125; <span class="keyword">catch</span> (Exception e)&#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">    	&#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">/**</span><br><span class="line">     * 建立数据的连接</span><br><span class="line">     * <span class="doctag">@exception</span> SQLException, ClassNotFoundException</span><br><span class="line">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Connection <span class="title">connectionDB</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">try</span>&#123;</span><br><span class="line">            Class.forName(DRIVER);</span><br><span class="line">            Connection conn = DriverManager.getConnection(URL, NAME, PASS);</span><br><span class="line">            <span class="comment">//System.out.println("连接数据库成功");</span></span><br><span class="line">            <span class="keyword">return</span> conn;</span><br><span class="line">        &#125;<span class="keyword">catch</span>(Exception e)&#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">            <span class="comment">//System.out.println("建立数据库发生错误！");</span></span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
</div></article></div><div class="paginator show"><a class="prev"> </a><a href="/2016/02/07/2015-2016/" class="next">回忆2014，辞旧2015，迎新2016<i class="fa fa-chevron-right"></i></a></div></section><footer class="footer"><div class="footer-inner"><div class="copyright">&copy; 2015 - <span class="copyrightYear">2016</span><span class="with-love"><i class="icon-next-heart fa fa-heart"></i></span><span itemprop="copyrightHolder" class="author"> Smile</span></div><div class="about"><div class="powered-by">由<a href="http://hexo.io" class="theme-link">Hexo</a>强力驱动</div><div class="theme-info">主题 -<a href="https://github.com/pinggod/hexo-theme-apollo" class="theme-link">Apollo</a><span>. Transform </span></div></div><div class="menu show-menu"><span class="menu-line-first"></span><span class="menu-line-middle"></span><span class="menu-line-last"></span></div><div class="menu-container"> <div class="smile-introduce"><div class="picture"><img src="/picture.png" alt="Smile.Fzm"></div><div class="name">Smile . Fzm</div><div class="quote"><i class="fa fa-quote-left"></i><p class="saying">业精于勤，荒于嬉；行成于思，毁于随。<p class="source">《进学解》·&nbsp;韩愈</p></p><i class="fa fa-quote-right"></i></div><div class="href"><a href="http://weibo.com/smileMessenger" target="_blank" class="nav-list-link"><i class="fa-weibo fa"> </i>Microblog</a><a href="https://twitter.com/Smile_Fzm" target="_blank" class="nav-list-link"><i class="fa-twitter fa"> </i>Twitter</a><a href="https://github.com/ifzm" target="_blank" class="nav-list-link"><i class="fa-github fa"> </i>GitHub</a></div><div class="address"><i class="fa-map-marker fa"> </i><span>Changsha - China</span></div></div></div><div class="menu back-to-top"></div></div></footer><script src="/js/jquery.lazyload.min.js"></script><script>$.lazyload = true</script><script src="/js/av-core-mini-0.6.1.js"></script><script>AV.initialize("T05D3O7mx9OL8NkpcWzdGtIo-gzGzoHsz", "o0hKtf18bqGVKMGvqK3xkz3J");</script><script src="/js/smile.js"></script></body></html>